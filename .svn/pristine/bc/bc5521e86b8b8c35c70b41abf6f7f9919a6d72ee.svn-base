# 1. Node.js 20 LTS (Slim 버전) 사용 - 가볍고 빠름
FROM node:20-slim

# 2. 컨테이너 내 작업 디렉토리 설정
WORKDIR /app

# 3. 의존성 설치 (캐싱 효율을 위해 package.json 먼저 복사)
COPY package*.json ./
RUN npm install

# 4. 소스 코드 전체 복사
COPY . .

# 5. Vite 포트 노출 (AWS 보안그룹에서 이 포트를 열어야 함)
EXPOSE 5173

# 6. 앱 실행 명령어
# npm run dev:https -> 우리가 만든 HTTPS 모드 실행
# -- --host 0.0.0.0 -> 컨테이너 외부(AWS)에서 접속 허용 
CMD ["npm", "run", "dev:https", "--", "--host", "0.0.0.0"]